<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Upload Tool</title>
</head>
<body>

  <h2>📤 Admin Upload Files</h2>
  <input type="file" id="fileInput" multiple />
  <button id="downloadJsonBtn" disabled>⬇️ Download JSON Index</button>

  <h3>📄 Uploaded Files:</h3>
  <ul id="fileList"></ul>

  <script>
    const fileInput = document.getElementById("fileInput");
    const fileList = document.getElementById("fileList");
    const downloadJsonBtn = document.getElementById("downloadJsonBtn");

    let fileData = [];

    fileInput.addEventListener("change", () => {
      fileData = [];
      fileList.innerHTML = "";
      downloadJsonBtn.disabled = false;

      Array.from(fileInput.files).forEach(file => {
        const url = URL.createObjectURL(file);

        fileData.push({
          name: file.name,
          url: url
        });

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = url;
        a.textContent = file.name;
        a.download = file.name;

        li.appendChild(a);
        fileList.appendChild(li);
      });
    });

    downloadJsonBtn.addEventListener("click", () => {
      const json = JSON.stringify({ files: fileData }, null, 2);
      const blob = new Blob([json], { type: "application/json" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "files.json";
      a.click();

      URL.revokeObjectURL(url);
    });
  </script>

</body>
</html>
